---
title: "Red, Red Wine"
author: Jason Horowitz
date: March 21, 2018
output: github_document
---

Red, Red Wine by Jason Horowitz
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using in your analysis in this code
# chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk. This
# prevents the code from displaying in the knitted HTML output. You should set
# echo=FALSE for all code chunks in your file, unless it makes sense for your
# report to show the code that generated a particular plot.

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.
setwd("/Users/jasonhorowitz/Desktop/DAND/t2-p2-project-EDA")
library(gridExtra)
library(plyr)
library(reshape2)
library(tidyverse) # includes ggplot2, dplyr, tidyr
library(GGally) # for scatterplot matrix
library(wesanderson)
library(grid) #for title on top of grid matrix
theme_set(theme_minimal(20))
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
rw <- read.csv("wineQualityReds.csv")
```
### Intro

Objective of this project is to perform EDA (exploratory data anlalysis) examining  relationships among variables in the red wine dataset. This is one of two datasets
presented by Udacity which relate to red and white variants of Portuguese Vinho 
Verde wine.

There are a total of 1599 observations (wines) in the dataset displaying twelve 
variables including eleven input variables (based on physicochemical tests) and 
 one output variable based on sensory data, a quality score.
 
The physico-chemical variables are (descriptive text from text file included with dataset):

1. **fixed acidity** (tartaric acid - g / dm^3): most acids involved with wine are 
fixed or nonvolatile (do not evaporate readily).
2. **volatile acidity** (acetic acid - g / dm^3): the amount of acetic acid in wine, 
which at too high of levels can lead to an unpleasant, vinegar taste.
2. **citric acid** (g / dm^3): found in small quantities, citric acid can add 'freshness' 
and flavor to wines.
4. **residual sugar** (g / dm^3): the amount of sugar remaining after fermentation stops,
it's rare to find wines with less than 1 gram/liter and wines with greater than
45 grams/liter are considered sweet.
5. **chlorides** (sodium chloride - g / dm^3): the amount of salt in the wine
6. **free sulfur dioxide** (mg / dm^3): the free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth 
and the oxidation of wine.
7. **total sulfur dioxide** (mg / dm^3): amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations
over 50 ppm, SO2 becomes evident in the nose and taste of wine.
8. **density** (g / cm^3): the density of wine is close to that of water depending 
on the percent alcohol and sugar content.
9. **pH**: describes how acidic or basic a wine is on a scale from 0 (very acidic) to 
14 (very basic); most wines are between 3-4 on the pH scale
10. **sulphates** (potassium sulphate - g / dm3): a wine additive which can contribute
to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant.
11. **alcohol** (% by volume): the percent alcohol content of the wine.
12. **quality** (score between 0 and 10):the median of at least 3 evaluations made by 
wine experts with grading  between 0 (very bad) and 10 (very excellent).

# Univariate Plots Section

```{r echo=FALSE, Univariate_Plots}
str(rw)

```

```{r}
# let's turn X into a factor
rw$X <- factor(rw$X)
# now let's rename X to something more appropriate like 'id'
colnames(rw)[1] <- "id"
# it may make sense to turn quality into a factor and then facet by quality
```

```{r}
summary(rw)
```

### Structure and Summary of Data

Our dataset consists of 12 variables (plus an index (X) which identifies the 
different wines). The variables are all number or integer data types. There are 
a total of nearly 1600 observations in the dataset. There are no missing values
and each row of the database equals one observation: so the dataset is both clean
and tidy.

### Histogram of Wine Quality Scores

For our first histogram, we plotted the wine quality scores. It is notable
that greater than 75% of the quality scores are concentrated in the middle (5-6) 
of the score range (1-10). The shape of the curve is normal-ish.

Also worth noting is that the Quality score is an integer data type despite the 
description that it is derived from observations of at least 3 experts. It would 
have been nice to have the precision of a decimal average for quality scores. On
the other hand, it simplifies things by making a bin = 1 optimal for displaying 
the distribution.

In fact, since the ratings are distributed across six integers (3-8), it's going
to make the most sense to convert this into a factor variable. The results will
coincide with the following ratings:

-  3 = "Awful"
-  4 = "Poor"
-  5 = "Fair"
-  6 = "Good"
-  7 = "Very Good"
-  8 = "Superior"
```{r}
# let's turn X into a factor
rw$quality <- factor(rw$quality)
str(rw$quality)
```

```{r}
ggplot(rw) +
  geom_histogram(aes(x = quality), color = "black",
                 fill = "#F79420", stat="count")
```

Following is the summary number of wines by quality score.

```{r}
summary(rw$quality)
```

### Histograms of Other Variables

Let's look at histograms of the other variables adjusting the binwidth as appropriate
to have a look at the distribution of values. I will also perform transformations 
on plots that require normalization.

Hopefully, plotting the variables and some minor additional research into them will
give us ideas for further investigation in the bivariate and multivariate analysis 
to follow.

#### Fixed Acidity

```{r}
# fixed acidity
ggplot(rw) +
  geom_histogram(aes(x = fixed.acidity), color = "black",
                 fill = "#FFFF66", binwidth = .1)

```
Since this appears to have a long-tail distribution, we will transform the variable
using the log base 10 scale.
```{r}
ggplot(rw) +
  geom_histogram(aes(x = fixed.acidity), color = "black",
                 fill = "#FFFF66", binwidth = .02) +
  scale_x_log10() +
  xlab("fixed.acidity log10")
```
With this transformation, the distribution of the data follows a more normal distribution.

#### Volatile Acidity

```{r}
# volatile acidity
ggplot(rw) +
  geom_histogram(aes(x = volatile.acidity), color = "black",
                 fill = "#CCFFCC", binwidth = .01)
```
The distribution for volatile acidity also seems to be longtailed - and with some
outliers. Let's perform a similar log10 transformation - also eliminating the top 
and bottom 1% of the values.
```{r}
ggplot(rw) +
  geom_histogram(aes(x = volatile.acidity), color = "black",
                 fill = "#CCFFCC", binwidth = .02) +
  scale_x_log10() +
  xlim(quantile(rw$volatile.acidity, 0.01),quantile(rw$volatile.acidity, 0.99)) +
  xlab("volatile.acidity log10")
```
As with fixed acidity, the transformed volatile acidity data follows a somewhat more
normal distribution.

#### Citric Acid

```{r}
ggplot(rw) +
  geom_histogram(aes(x = citric.acid), color = "black",
                 fill = "#FF66CC", binwidth = .02)
```
A signicant number of wines have citric acid near 0. Let's check how many actually 
have no trace of citric acid.
```{r}
# r code to count number of items at a specific value
no_citric <- subset(rw, citric.acid == 0)
dim(no_citric)
dim(no_citric)[1]/dim(rw)[1]
```
So 132 items (8.2% of the observations) contain no trace of citric acid. This makes 
sense because the citric acid most usally found in wine is  a supplement added after 
primary alcohol fermentation (citric acid is present only in minute quantities in 
grapes) In the European Union, use of citric acid for acidification is prohibited, 
but limited use of citric acid is permitted for removing excess iron and copper 
from the wine if potassium ferrocyanide is not available. [Wikipedia](https://en.wikipedia.org/wiki/Acids_in_wine#cite_note-Oxford_pg_171-6)

Also note - 
Citric acid imparts a citric character that enhances the taste of many white and 
blush wines. However, citric acid is seldom used in red wine. The distinctive citric 
taste may not be appropriate for many types of red wine. In addition, the risk of 
biological instability is much greater in red wines.[Lum Eisenman, *The Home Winemaker's Manual*](https://www.homebrewit.com/a-detailed-explanation-of-acids-used-in-wine-making)

The description that came with the dataset about citric acid adding 'freshness 
and flavor' to wine seems as though it may not apply to red wines. It certainly will 
be interesting to see how citric acid (and its absence) correlates with wine quality
in this particular dataset. It's also worth noting that most wines in this dataset 
do contain traces of citric acid even though these are all red wines.

#### Total Acid

Let's compute the sum of the three forms of acid identified in the dataset to make
a 'total.acidity' variable. I would hypothesize that this sum should have a very strong
negative correlation with pH (see below) in which the lower the value, the stronger
the acid.

```{r}
# create new variable total.acid - the sum of the other three types of acidity
rw$total.acidity <- rw$fixed.acidity + rw$volatile.acidity +
  rw$citric.acid
```

Next, let's look at the structure of the new variable.

```{r}
# summary of total.acidity variable
summary(rw$total.acidity)
```
Glancing at the summary values, it looks like this is going to be right-skewed with 
a long tale at the higher values. Let's plot a histogram to confirm.

```{r}
ggplot(rw) +
  geom_histogram(aes(x = total.acidity), color = "black",
                 fill = "#ff2400", binwidth = .1)
```
Yep, that hypothesis was correct.

#### Residual Sugar
```{r}
ggplot(rw) +
  geom_histogram(aes(x = residual.sugar), color = "black",
                 fill = "#993300", binwidth = .05)
```
Residual sugar seems to have a very long tail, so let's perform a log 10 transformation.

```{r}
ggplot(rw) +
  geom_histogram(aes(x = residual.sugar), color = "black",
                 fill = "#993300", binwidth = .05) +
  scale_x_log10() +
  xlab("residual.sugar_log10")
  
```
Still a long tail, but the middle of the distribution is more clearly normalish. Let's try doing this a different way to see if we can eliminate the outliers.

```{r}
ggplot(rw) +
  geom_histogram(aes(x = residual.sugar), color = "black",
                 fill = "#993300", binwidth = .1) +
  scale_x_continuous(lim = c(0, quantile(rw$residual.sugar, 0.95))) +
  xlab("residual.sugar_95th percentiles")
```
That's a little better.

#### Chlorides

This is the amount of salt (sodium chloride) found in the wine.

```{r}
ggplot(rw) +
  geom_histogram(aes(x = chlorides), color = "black",
                 fill = "#9999FF", binwidth = .005)
```
Chlorides definitely has a long-tail, so let's try removing the outliers.  I have 
never experienced salt in wine as a good thing, so it would also be interesting to 
examine the outliers on the high end of the scale.

```{r}
ggplot(rw) +
  geom_histogram(aes(x = chlorides), color = "black",
                     fill = "#9999FF", binwidth = .002) +
  scale_x_continuous(lim = c(quantile(rw$chlorides, 0.01), quantile(rw$chlorides, 0.95))) +
  xlab('chlorides_95thPercentile')

```
This plot definitely is more normal in its appearance than the previous one.

#### Free Sulfur Dioxide

```{r}
ggplot(rw) +
  geom_histogram(aes(x = free.sulfur.dioxide), color = "black",
                 fill = "#99FF99", binwidth = 1)
```
#### Total Sulfur Dioxide

```{r}
ggplot(rw) +
  geom_histogram(aes(x = total.sulfur.dioxide), color = "black",
                 fill = "#669933", binwidth = 1)
```
Sulfur dioxide in both its free and bound form is used as a preservative (see above). 
Since the plots for both are right skewed, let's perform a square root transformation 
on each.

First on the free sulfur dioxide:

```{r}
ggplot(rw) +
  geom_histogram(aes(x = sqrt(free.sulfur.dioxide)), color = "black",
                 fill = "#99FF99", binwidth = .25)
```
And total sulfur dioxide

```{r}
ggplot(rw) +
  geom_histogram(aes(x = sqrt(total.sulfur.dioxide)), color = "black",
                 fill = "#669933", binwidth = .25)
```
That mostly got rid of the right skew and the curves are  more normal.

#### Density

```{r}
ggplot(rw) +
  geom_histogram(aes(x = density), color = "black",
                 fill = "#660033", binwidth = .0005)
```
Density is a quite a normal distribution with few outliers: mean and median are 
almost identical. 


#### pH (Overall Acidity)
```{r}
ggplot(rw) +
  geom_histogram(aes(x = pH), color = "black",
                 fill = "#CC0033", binwidth = .05)

```

pH (overall acidity) also shows a normalish distribution with few outliers.

#### Sulphates

```{r}
ggplot(rw) +
  geom_histogram(aes(x = sulphates), color = "black",
                 fill = "#CCFF00", binwidth = .05)

```

Sulphates, an additive which serves as a preservative, demonstrates a right skewed 
curve with a long tail.  Let's see what how it looks after a square root transformation.


```{r}
ggplot(rw) +
  geom_histogram(aes(x = sqrt(sulphates)), color = "black",
                 fill = "#CCFF00", binwidth = .02) +
  scale_x_continuous(lim = c(0.5, quantile(rw$sulfates, 0.95)))

```
That's normalish.

#### Alcohol Content % By Volume

```{r}
# alcohol content % by volume
ggplot(rw) +
  geom_histogram(aes(x = alcohol), color = "black",
                 fill = "#FF6666", binwidth = .1)
```
```{r}
summary(rw$alcohol)
```

Alcohol content by volume is slightly right-skewed and in the 9.5-11 range. This 
is fairly intutive to anyone who drinks wine. It will be interesting to look at correlations 
between high/low alcohol content and the quality score.


# Univariate Analysis

### What is the structure of your dataset?

The structure of the dataset is as discussed in the "Structure and Summary" section
above. One major transformation we made in EDA was converting the output variable 
"quality"from an integer value to a factor. Another item was adding a variable - 
total.acidity - which is the sum of the three acid(ity) variables.

### What is/are the main feature(s) of interest in your dataset?

The main feature of interest is the distribution of the quality variable. More than
three-quarters of the observations are of the middle two ratings which means that 
only about 400 items were classified at either the upper or lower extremes. It should
be possible to examine that group of 'very good' or 'very bad' wines and to correlate
with other variables.

A few of the input variables appear to be related to each other: the variables related
to acidity and to sulfur dioxide. It will be interesting to see how those items 
correlate with each other and with the quality score.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

Biggest question for me is how/whether the different input variables correlate 
or predict the output variable, quality. Am particularly curious to see how
alchohol level correlates with quality. Will also be interesting to see how the different acidity-related variables correlate with each other and with quality.


### Did you create any new variables from existing variables in the dataset?

As mentioned previously, I did create a total.acidity variable by summing up three 
other acid(ity) variables and we also transformed two of the existing variables:
('X' and 'quality') into factor variables. We don't need these variables to be 
summarized and it makes more intuitive sense for these variables to be factors.

### Of the features you investigated, were there any unusual distributions? \
## Did you perform any operations on the data to tidy, adjust, or change the form \
### of the data? If so, why did you do this?

Yes, several of the variables'  plots displayed a skew or a relatively large number 
of outliers. I transformed these variables using base-10 logarithims, square root 
operations, or, in a couple cases, by cutting off the outliers. As a result, the 
transformed plots were easier to read and showed more normal distributions.

# Bivariate Plots Section

> **Tip**: Based on what you saw in the univariate plots, what relationships
between variables might be interesting to look at in this section? Don't limit
yourself to relationships between a main output feature and one of the
supporting variables. Try to look at relationships between supporting variables
as well.

*Note* - proper way to convert factor to numeric and back is - 
[described in the link](https://stackoverflow.com/questions/3418128/how-to-convert-a-factor-to-integer-numeric-without-loss-of-information) **need to refactor code**

### Experimental Plots

The first thing we are going to do is to copy the rw dataframe so that subsequent 
transformations do not affect the original df. We will convert the quality variable
to an integer data type in order to calculate correlation coefficients.

```{r echo=FALSE, Bivariate_Plots}
# make a copy of rw dataframe
rw_copy <- cbind(rw)
# convert the 'quality' variable from categorical to numeric so R will be able to 
# calculate  correlation coefficients
rw_copy$quality <- as.numeric(levels(rw_copy$quality))[as.integer(rw_copy$quality)]
# check it make sure conversion was made
str(rw_copy)
```

Next we will subset the dataframe to plot acid-related variables with each other
and against quality.
```{r}
# subsetting dataframe keying on acid-related variables
rw_acid  <-  rw_copy[ ,c('quality', 'pH', 'total.acidity', 'fixed.acidity', 'volatile.acidity', 'citric.acid')]
str(rw_acid)

```
Here is the plot (made using the ggpairs function of the ggally library):

```{r}
ggpairs(rw_acid, axisLabels = 'internal') 
# experimental stuff: delete for final version
# rw_acid$quality_factor <- as.factor(rw_acid$quality)
# str(rw_acid)
# ggscatmat(rw_acid, columns = 2:6, color="quality_factor", alpha=0.3)

```

As expected, the correlations among the acid-related variables are quite high and
in some cases approach 1.

The greatest correlations between acidity and quality are  volatile acidity (negative correlation - medium) and citric acid (positive correlation - weak). Volatile
acidity of wine is aceitic acid which at high quantities gives the taste of [balsamic
vinegar](https://winefolly.com/tutorial/wine-faults/) so the negative correlation
is not surprising. Citric acid is a flavor enhancer in white wines, but as noted
above is not allowed by the EU in red wine, so the positive correlation is a bit
more surprising. Perhaps iron and copper are introduced via the grape crushing process
and citric acid is used (as permitted) to remove their traces.

I was  surprised at the nearly 100% correlation between fixed acidity and total 
acidity, but a visual inspection of the dataframe shows that I should not have been.

```{r}
# dataframe with acids sample
sample_n(rw_acid,3)
```
Fixed acidity is by far the largest component of total acidity in grams per volume (dm^3). Since the definition of a 'fixed' acid is that it does not easily evaporate, this 
makes sense. There is hardly any correlation between either total or fixed acidity
and quality.

### Alcohol and Residual Sugar

Let's examine another theoretically related pair of variables: alchohol and residual.sugar. Since alcohol in wine is created during fermentation by chemical reaction with sugar
in grapes, our hypothesis is the higher the level of alcohol, the lower the amount
of residual sugar.

First let's subset the dataframe:

```{r}
rw_sugalc  <-  rw_copy[ ,c('quality', 'alcohol', 'residual.sugar')]
rw_copy$quality_factor <- as.factor(rw_copy$quality)
```

Let's view a scatterplot of residual sugar vs. alchohol (faceted by quality). In
order to make the high and low quality wines more visible, I filtered out the 75% of observations in the medium quality (5-6) range.

```{r}
ggplot(data = subset(rw_copy, quality > 6 | quality < 5), aes(y = residual.sugar, x = alcohol, color = quality_factor)) +
  geom_point(alpha=.3) +
  scale_color_brewer(palette ='Set1')+
  ggtitle("Alcohol vs. Residual Sugar over Quality")

```

It actually does look as though the superior quality scores (8) tend to be higher 
in alcohol content (though a bit all over the place in terms of residual sugar).
The wines that scored lower in quality (3-4) are grouped on the lower side of the 
alcohol/volume scale (and are also all over the place in terms of residual sugar).

Let's look at the actual correlation for the entire sample between alcohol content
and residual sugar.

```{r}
cor(rw_sugalc$alcohol,rw_sugalc$residual.sugar)
```

Hypothesis here appears to be incorrect since the correlation coefficient is very 
small. A little Google research on wine yields some clues - see the following citations.

> Since we’ve noted that fermentation converts grape sugars to alcohol, there’s 
> definitely a relationship between a wine’s residual or unconverted sugar and its 
> alcohol level. The more residual sugar, the lower the potential alcohol that wine 
> could have. But it’s not a simple relationship—there are other factors at play, 
> particularly how much sugar the grapes had to begin with. Two wines could have 
> widely different alcohol percentages but the same amount of residual sugar—or 
> vice versa—depending on how ripe the grapes were. 
> [Wine Spectator](https://www.winespectator.com/drvinny/show/id/50489)

> So, while there’s definitely a loose relationship between a wine’s residual sugar 
> and its alcohol level, it’s not a simple relationship.
> [EverWonderWine? Blog](https://www.everwonderwine.com/blog/2017/1/14/is-there-a-relationship-between-a-wines-alcohol-level-and-its-sweetness)

Since it is alcohol content that has the greater correlation with quality, we'll
explore that further.

Let's examine another scatterplot matrix, this time using those variables which
we suspect may be correlated with quality:

- volatile acidity
- citric acid
- chlorides
- sulphates
- alcohol

```{r}

# subset using dplyr select function
rw_matrix  <-  select(rw_copy,c(id,quality,volatile.acidity,citric.acid, chlorides,
                                sulphates,alcohol))
# scatterplot matrix using ggpairs function
ggpairs (rw_matrix, columns = 2:7, axisLabels = 'internal')

```

The correlation coefficients are pretty informative; the plots somewhat less so.
The input variables that correlate with quality are:

- volatile acidity - medium (negative) 0.391
- citric acid - low 0.225
- sulphates - low 0.251
- alcohol - medium .476

The input variables that correlate with other variables are:
- citric acid and volatile acidity - medium (negative) 0.552
- citric acid and chlorides - low 0.204
- citric acid and sulphates - medium 0.313
- chlorides and sulphates - medium 0.371
- sulphates and volatile acidity - low (negative) 0.261
- alcohol and chlorides - low (negative) 0.221
- alcohol and volatile acidity - low (negative) 0.202

Alright, I'm going to run the same scatterplot using the dataframe with the 5-6 
quality range filtered out to see if anything stands out at the high and low ranges.

```{r}
# ggpairs scatterplot matrix on subset filtering out middle ranges
ggpairs (subset(rw_matrix, quality > 6 | quality < 5), columns = 2:7, 
         axisLabels = 'internal')

```
The correlations are slightly stronger for wines at higher and lower quality ratings
which make the scatterplots easier to interpret.

## Boxplots for Key Input Variables Across Quality 

The following series of boxplots will visualize the input variables with higher
correlation coefficients across the factorized Quality variable.

#### Alcohol and Quality

```{r}
ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = alcohol)) +
  geom_boxplot(aes(fill=factor(quality)))
```
The correlation of higher alcohol/volume with higher quality is clearly seen here
particularly at the higher quality ratings.

#### Alcohol/Volume Faceted by Quality Level

These are the summary stats which are depicted  in the above boxplot.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# tapply(rw_copy$alcohol, rw_copy$quality_factor, summary)
by(rw_copy$alcohol, factor(rw_copy$quality), summary)
```

#### Sulphates and Quality

```{r}
ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = sulphates)) +
  geom_boxplot(aes(fill=factor(quality)))
```

The weak correlation between sulphates and quality is nevertheless visible.

#### Citric Acid and Quality

```{r}
ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = citric.acid)) +
  geom_boxplot(aes(fill=factor(quality)))
```
The correlation between citric acid and quality is also visible here. However the
overlap in valuesindicated by the interquartile range and the substantial number 
of wines with no citric acid (discussed above) discount the correlation.

#### Volatile Acidity and Quality

```{r}
ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = volatile.acidity)) +
  geom_boxplot(aes(fill=factor(quality)))
```

The inverse correlation between volatile acidity and quality is visible here. This
is the second-strongest correlation after  alchohol.


# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. \ How did the feature(s) of interest vary with other features in \ the dataset?

Much of the analysis here is offered inline (above). 

The two strongest relationships with quality variable are the positive correlation 
with alcohol and the negative one with volatile acidity. If I were to create a model
predicting which items account for most of a high quality score it would be based
on these two variables. Show me a vinho verde with high alcohol content per volume 
and low volatile acidity and I'll bet you it's highly rated wine.

### Did you observe any interesting relationships between the other features \(not the main feature(s) of interest)?

Yes,the positive correlations among the various acids and acidity-related variables 
confirms the validity of the data.  It was also interesting not to find an expected
(negative correlation beteween alcohol and residual sugar level).

### What was the strongest relationship you found?

The strongest relationship in this dataset is between alcohol and quality and also 
among the various acidity variables.

# Multivariate Plots Section

#### Volatile Acidity and Alcohol Over Quality

These are the two strongest relationships with quality - volatile acidity is a 
negative correlation and alcohol is a positive one. Setting up alcohol on the x-axis
and volatile acidity on the y-axis, I would expect to see most of the high quality 
wine in the lower right-hand portion of the plot and the lower-quality ones on the
upper left.  To make the visualization more comprhensible, I'm going to plot a subset excluding the 1200 values in the medium (5-6) quality range.

```{r echo=FALSE, Multivariate_Plots}
ggplot(data = subset(rw_copy, quality > 6 | quality < 5), aes(y = volatile.acidity, 
                                                              x = alcohol, color =
                                                                quality_factor)) +
  geom_jitter(alpha=0.6) +
  scale_color_manual(values = wes_palette("Darjeeling1")) +
  ggtitle("Alcohol vs. Volatile Acidity over Quality
          (Upper and Lower Subset)")
```

Bingo! This was exactly what we were expecting.

For completeness, here are same items plotted for the entire dataset.

```{r}
ggplot(data = rw_copy, aes(y = volatile.acidity, x = alcohol, color=quality_factor)) +
  geom_jitter(alpha=0.3) +
  scale_color_manual(values = wes_palette(8, name="Darjeeling1", type="continuous")) +
  ggtitle("Alcohol vs. Volatile Acidity over Quality 
          (Full Dataset)")
#pal <- wes_palette(21, name = "Zissou1", type = "continuous")
```
#### Alcohol vs. Sulphates Over Quality

Sulphates ("a wine additive which acts as an antimicrobial and antioxidant") correlates
weakly with both quality and volatile acidity.  Let's plot the relationships among 
these three variables.

```{r}
ggplot(data = subset(rw_copy, quality > 6 | quality < 5), aes(y = sulphates, x = alcohol, color = quality_factor)) +
  geom_jitter(alpha=0.6) +
  scale_color_manual(values = wes_palette(8, name="Darjeeling1", type="continuous"))+
  ggtitle("Alcohol vs. Sulphates over Quality")
```

The relationship between alcohol/volume and quality is again clearly visible; the 
correlation between sulpahates, quality and alcohol is weak, but also visible.

```{r}
ggplot(data = subset(rw_copy, quality > 6 | quality < 5), aes(y = sulphates, x =
                                                              volatile.acidity, color =
                                                                quality_factor)) +
  geom_jitter(alpha=0.6) +
  scale_color_manual(values = wes_palette(8, name="FantasticFox1", type="continuous")) +
  ggtitle("Volatile Acidity vs. Sulphates over Quality")
```

Since sulphates and volatile acidity have a negative correlation and both have a 
relationship with quality, I though I might see a pretty clear negative slope in 
this plot. There is a slight negative slope indicating the correlation between the 
two input variables.  And these  seem to correlate with  quality, but honestly, 
relationships are not as clear as I had hoped.

```{r}
ggplot(data = rw, aes(y = pH, x = alcohol, color = factor(quality))) +
  geom_point() +
  scale_color_brewer()+
  ggtitle("Alcohol vs. pH over Quality")

ggplot(data = rw, aes(y = sulphates, x = alcohol, color = factor(quality))) +
  geom_point() +
  scale_color_brewer()+
  ggtitle("Alcohol vs. Sulphates over Quality")

ggplot(data = rw, aes(y = volatile.acidity, x = alcohol, color = factor(quality))) +
  geom_point() +
  scale_color_brewer()+
  ggtitle("Alcohol vs. Volatile Acidity over Quality")
```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE, Plot_One}
# distribution of the quality variable
# histogram
ggplot(rw_copy) +
  geom_histogram(aes(x = quality_factor,binwidth=1), color = "black",
                 fill = "#F79420", stat="count") +
  xlab("Quality")
```
```{r}
# summary of descriptive stats          
summary(rw_copy$quality_factor)
```

### Description for Plot One

Sometimes the most descriptive stats are the simplest count statistics. This is 
one of those cases....

### Plot Two
```{r echo=FALSE, Plot_Two}

x <- ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = alcohol)) +
  geom_boxplot(aes(fill=factor(quality))) +
  xlab("Quality") +
  theme(legend.position="none")

y <- ggplot(data = rw_copy, mapping = aes(x = factor(quality), y = volatile.acidity)) +
  geom_boxplot(aes(fill=factor(quality))) +
  xlab("Quality") +
  theme(legend.position="none")


grid.arrange(x, y, ncol = 2, top=textGrob("Box Plots: Top Input Variables",
                                          gp=gpar(fontsize=14,font=8)))


```

### Description Two

There are several ways to understand the correlation between quality and alchohol
and quality and volatile acid, but in my view the box plots are the best visualization.

### Plot Three
```{r echo=FALSE, Plot_Three}

ggplot(data = subset(rw_copy, quality > 6 | quality < 5), aes(y = volatile.acidity, 
                                                              x = alcohol, color =
                                                                quality_factor)) +
  geom_jitter(alpha=0.6) +
  scale_color_manual(values = wes_palette("Darjeeling1")) +
  ggtitle("Alcohol vs. Volatile Acidity over Quality
          (Upper and Lower Subset)")
```

### Description Three

This is the plot which shows most clearly the two greatest relationships with Quality
as discussed above. The plot is easier to understand with the middle values removed.

------

# Reflection

This project demonstrates the power of R and the GGPlot libarary to easily set up
and modify visualizations. Using the precleaned red wine dataset eliminated some of
the difficulties inherent in data wrangling, but because the data is so limited it
also reduced the possibilities for interesting discovery.

Clear relationships among alcohol, volatile acidity, and quality.  Knowing what I 
know as a wine drinker wouldn't  generalize these insights to all wines, but would
focus on specific qualities of Vinho Verde.  For instance, I don't think it is true 
that higher alcohol wines are better, but within the Vinho Verde family that did
seem to be the case.

This was a lot of work. That was partially because R is a new language, but it also
demonstrated to me that it's important to keep research to topics that are more 
interesting to you.

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!